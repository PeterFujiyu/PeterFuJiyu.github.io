<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Peter的主页</title>
        <style>
            /* CSS 样式 */

            /* ... 省略其他样式 ... */

            .pending-post {
                background-color: #ffffcc; /* 黄色 */
                padding: 10px;
                margin-bottom: 10px;
            }

            .approve-button {
                background-color: #00cc00; /* 绿色 */
                color: #fff;
                padding: 5px 10px;
                margin-right: 5px;
                border: none;
                cursor: pointer;
            }

            .delete-button {
                background-color: #cc0000; /* 红色 */
                color: #fff;
                padding: 5px 10px;
                border: none;
                cursor: pointer;
            }
        </style>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
        <script>
            var password = ""; // 存储加密后的密码
            var pendingPosts = []; // 存储待审核的帖子列表

            function encryptPassword(password) {
                var hash = CryptoJS.SHA256(password).toString();
                return hash;
            }

            function savePasswordToFile(password) {
                localStorage.setItem("password", password);
            }

            function readPasswordFromFile() {
                var encryptedPassword = localStorage.getItem("password");
                return encryptedPassword || "";
            }

            function validatePassword(input) {
                var inputHash = encryptPassword(input);
                return inputHash === password;
            }

            password = readPasswordFromFile();

            if (!password) {
                var newPassword = prompt("请设置密码");
                password = encryptPassword(newPassword);
                savePasswordToFile(password);
            }

            function resetPassword() {
                var newPassword = prompt("请输入新密码");
                password = encryptPassword(newPassword);
                savePasswordToFile(password);
            }

            function addPost() {
                var postContent = document.getElementById("postContent").value;

                var post = {
                    content: postContent,
                    approved: false
                };

                pendingPosts.push(post);

                var postElement = document.createElement("div");
                postElement.className = "pending-post";
                postElement.innerHTML = `
                    <p>${post.content}</p>
                    <button class="approve-button" onclick="approvePost(this)">审核通过</button>
                    <button class="delete-button" onclick="deletePost(this)">删除</button>
                `;

                var postList = document.getElementById("postList");
                postList.appendChild(postElement);

                document.getElementById("postContent").value = "";
            }

            function approvePost(button) {
                var postElement = button.parentNode;
                var postContent = postElement.querySelector("p").innerText;

                var input = prompt("请输入密码");

                if (validatePassword(input)) {
                    var approvedPostElement = document.createElement("p");
                    approvedPostElement.innerText = postContent;

                    var approvedPostList = document.getElementById("approvedPostList");
                    approvedPostList.appendChild(approvedPostElement);

                    postElement.remove();

                    // 在待审核帖子列表中查找并标记帖子为已审核通过
                    var index = pendingPosts.findIndex(post => post.content === postContent);
                    if (index !== -1) {
                        pendingPosts[index].approved = true;
                    }
                } else {
                    alert("密码错误，无法审核帖子");
                }
            }

            function deletePost(button) {
                var postElement = button.parentNode;
                postElement.remove();
            }

            function updatePostLists() {
                var postList = document.getElementById("postList");
                var approvedPostList = document.getElementById("approvedPostList");

                // 清空帖子列表
                postList.innerHTML = "";
                approvedPostList.innerHTML = "";

                // 遍历待审核帖子列表，根据审核状态添加到相应的列表中
                pendingPosts.forEach(post => {
                    if (post.approved) {
                        var approvedPostElement = document.createElement("p");
                        approvedPostElement.innerText = post.content;
                        approvedPostList.appendChild(approvedPostElement);
                    } else {
                        var postElement = document.createElement("div");
                        postElement.className = "pending-post";
                        postElement.innerHTML = `
                            <p>${post.content}</p>
                            <button class="approve-button" onclick="approvePost(this)">审核通过</button>
                            <button class="delete-button" onclick="deletePost(this)">删除</button>
                        `;
                        postList.appendChild(postElement);
                    }
                });
            }

            // 在密码验证时更新帖子列表
            function validatePassword(input) {
                var inputHash = encryptPassword(input);
                if (inputHash === password) {
                    updatePostLists();
                    return true;
                } else {
                    return false;
                }
            }
        </script>
    </head>
    <body>
        <div class="topbar">
            <h1>欢迎来到Peter的主页</h1>
            <ul>
                <li><a href="#about">关于我</a></li>
                <li><a href="#contact">联系我</a></li>
                <li><a href="#donate">捐赠</a></li>
                <li><a href="#linux">Linux</a></li>
                <li><a href="https://github.com/PeterFujiyu/">Main</a></li>
            </ul>
        </div>

        <header>
            <h1>欢迎来到Peter的主页</h1>
        </header>

        <main>
            <section id="about">
                <h2>关于我</h2>
                <p>我是Peter，一名热爱编程和开源技术的开发者。我喜欢探索新的技术和解决有趣的问题。</p>
                <p>通过我的主页，你可以了解更多关于我的信息和项目。</p>
                <button onclick="window.location.href='https://github.com/PeterFujiyu';">
                    访问我的Github主页
                </button>
            </section>

            <section id="contact">
                <h2>联系我</h2>
                <p>如果你想与我联系，请发送电子邮件至 <a href="mailto:jiyu.fu@outlook.com">jiyu.fu@outlook.com</a>。</p>
            </section>

            <section id="donate">
                <h2>捐赠</h2>
                <p>如果你愿意捐赠支持我的工作，我接受数字货币捐赠。以下是我的捐赠地址：</p>
                <ul>
                    <li><b>ERC20 Token:</b> 0x5f48e2b11e45f7b8bb2c20628a9b77d1d25e7f4f</li>
                    <li><b>BEP20 Token:</b> 0x5f48e2b11e45f7b8bb2c20628a9b77d1d25e7f4f</li>
                </ul>
                <p>如果你希望使用其他类型的数字货币进行捐赠，请发送电子邮件给我，我可以提供几乎所有数字货币的地址。</p>
            </section>

            <section id="linux">
                <h2>Linux</h2>
                <p>在这个部分，你可以了解有关Linux的信息。</p>

                <h3>待审核帖子列表</h3>
                <div id="postList"></div>

                <h3>审核通过的帖子列表</h3>
                <div id="approvedPostList"></div>

                <h3>添加帖子</h3>
                <textarea id="postContent" placeholder="请输入帖子内容"></textarea>
                <br>
                <button onclick="addPost()">提交</button>
            </section>
        </main>

        <footer>
            <p>© 2023 Peter的主页</p>
        </footer>
    </body>
</html>
